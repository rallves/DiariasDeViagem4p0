SELECT NVL(MAX(CODREGISTRO), 0)+1 CODREGISTRO
FROM AD_ADVDESP
WHERE IDINSTPRN = :IDINSTPRN